!function(t){var i={};function e(r){if(i[r])return i[r].exports;var a=i[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)e.d(r,a,function(i){return t[i]}.bind(null,a));return r},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";e.r(i);e(2);const r=e(1);!function(){var t,i,e,a,s,n,o,h,m,y,u,d,l,b,f,c,p,g="./static/tinyHeart/images/",x=0;window.jzk={},jzk.startgame=function(){jzk.init(),o=Date.now(),jzk.gameLoop()},jzk.init=function(){t=document.getElementById("canvas1"),e=t.getContext("2d"),i=document.getElementById("canvas2"),a=i.getContext("2d"),e.fillStyle="white",e.font="20px 微软雅黑",e.textAlign="center",t.addEventListener("mousemove",jzk.onMouseMove,!1),t.addEventListener("click",jzk.onClick,!1),s=t.width,n=t.height,f=.5*s,c=.5*n,(h=new v).init(),(m=new w).init(),(y=new I).init(),(u=new T).init(),d=new A,(l=new E).init(),(b=new B).init(),(p=new M).init()},jzk.gameLoop=function(){requestAnimFrame(jzk.gameLoop);var t=Date.now();x=t-o,o=t,x>40&&(x=40),a.clearRect(0,0,s,n),can2App.drawBackgorund(),h.drawAne(),function(){for(var t=0,i=0;i<m.num;i++)m.alive[i]&&t++;if(t<15)(function(){for(var t=0;t<m.num;t++)if(!m.alive[t])return m.born(t),!1})()}(),m.drawFruit(),e.clearRect(0,0,s,n),y.drawMom(),u.drawBaby(),d.gameOver||(jzk.momEatFruit(),jzk.momFoodBaby()),d.drawScore(),l.drawWave(),b.drawHalo(),p.drawDust()},jzk.onMouseMove=function(t){d.gameOver||(t.offsetX||t.layerX)&&(f=void 0==t.offsetX?t.layerX:t.offsetX,c=void 0==t.offsetY?t.layerY:t.offsetY)},jzk.onClick=function(){d.gameOver&&(d.gameOver=!1,m.init(),y.init(),u.init(),d.init())},jzk.momEatFruit=function(){for(var t=0;t<m.num;t++){if(m.alive[t]&&m.grow[t])r.calLength2(m.x[t],m.y[t],y.x,y.y)<30&&(m.dead(t),l.born(t),d.fruitNum++,y.momBodyIndex=7==y.momBodyIndex?y.momBodyIndex:y.momBodyIndex+1,"blue"==m.type[t]&&d.doubleNum++)}},jzk.momFoodBaby=function(){if(d.fruitNum>0&&r.calLength2(y.x,y.y,u.x,u.y)<30){b.born(),y.momBodyIndex=0;var t=d.doubleNum*d.fruitNum,i=u.babyBodyIndex-t;i<0&&(i=0);var e=d.strength+(i/2).toFixed(0);e>10&&(e=10),d.strength=e,u.babyBodyIndex=i,d.computeScore()}},window.can2App={},can2App.drawBackgorund=function(){var t=new Image;t.src=g+"background.jpg",a.drawImage(t,0,0,s,n)};var v=function(){this.num=50,this.rootx=[],this.headx=[],this.heady=[],this.amp=[],this.beta=0};v.prototype.init=function(){for(var t=0;t<this.num;t++)this.rootx[t]=18*t+30*Math.random(),this.headx[t]=this.rootx[t],this.heady[t]=n-220+50*Math.random(),this.amp[t]=50*Math.random()+60},v.prototype.drawAne=function(){this.beta+=8e-4*x;var t=Math.sin(this.beta);a.save(),a.globalAlpha=.7,a.lineWidth=20,a.lineCap="round",a.strokeStyle="#3b154e";for(var i=0;i<this.num;i++){var e=this.headx[i]+t*this.amp[i];a.beginPath(),a.moveTo(this.rootx[i],n),a.quadraticCurveTo(this.rootx[i],n-100,e,this.heady[i]),a.stroke()}a.restore()};var w=function(){this.num=30,this.x=[],this.y=[],this.size=[],this.type=[],this.speed=[],this.grow=[],this.alive=[],this.orange=new Image,this.blue=new Image};w.prototype.init=function(){this.orange.src=g+"fruit.png",this.blue.src=g+"blue.png";for(var t=0;t<this.num;t++)this.x[t]=this.y[t]=0,this.speed[t]=.015*Math.random()+.005,this.alive[t]=!1,this.grow[t]=!1,this.type[t]=""},w.prototype.drawFruit=function(){for(var t=0;t<this.num;t++)if(this.alive[t]){this.size[t]<=16?(this.grow[t]=!1,this.size[t]+=this.speed[t]*x*.8):(this.grow[t]=!0,this.y[t]-=5*this.speed[t]*x);var i=this.orange;"blue"==this.type[t]&&(i=this.blue),a.drawImage(i,this.x[t]-.5*this.size[t],this.y[t]-.5*this.size[t],this.size[t],this.size[t]),this.y[t]<8&&(this.alive[t]=!1)}},w.prototype.born=function(t){var i=Math.floor(Math.random()*h.num);this.x[t]=h.headx[i],this.y[t]=h.heady[i],this.size[t]=0,this.alive[t]=!0;var e=Math.random();this.type[t]=e<.1?"blue":"orange"},w.prototype.dead=function(t){this.alive[t]=!1},window.can1App={};var I=function(){this.x=0,this.y=0,this.angle,this.momTailArr=[],this.momTailTimer=0,this.momTailIndex=0,this.momEyeArr=[],this.momEyeTimer=0,this.momEyeIndex=0,this.momEyeInterval=1e3,this.momOrangeArr=[],this.momBlueArr=[],this.momBodyIndex=0};I.prototype.init=function(){this.x=.5*s,this.y=.5*n,this.angle=0;for(var t=0;t<8;t++)this.momTailArr[t]=new Image,this.momTailArr[t].src=g+"bigTail"+t+".png";for(t=0;t<2;t++)this.momEyeArr[t]=new Image,this.momEyeArr[t].src=g+"bigEye"+t+".png";for(t=0;t<8;t++)this.momOrangeArr[t]=new Image,this.momOrangeArr[t].src=g+"bigSwim"+t+".png",this.momBlueArr[t]=new Image,this.momBlueArr[t].src=g+"bigSwimBlue"+t+".png"},I.prototype.drawMom=function(){this.x=r.lerpDistance(f,this.x,.96),this.y=r.lerpDistance(c,this.y,.98);var t=f-this.x,i=c-this.y,a=Math.atan2(i,t)+Math.PI;this.angle=r.lerpAngle(a,this.angle,.6),this.momTailTimer+=x,this.momTailTimer>50&&(this.momTailIndex=(this.momTailIndex+1)%8,this.momTailTimer%=50),this.momEyeTimer+=x,this.momEyeTimer>this.momEyeInterval&&(this.momEyeIndex=(this.momEyeIndex+1)%2,this.momEyeTimer%=this.momEyeInterval,0==this.momEyeIndex?this.momEyeInterval=1500*Math.random()+1500:this.momEyeInterval=200),e.save(),e.translate(this.x,this.y),e.rotate(this.angle);var s,n=this.momTailArr[this.momTailIndex];e.drawImage(n,.5*-n.width+30,.5*-n.height),s=1!=d.doubleNum?this.momBlueArr[this.momBodyIndex]:this.momOrangeArr[this.momBodyIndex],e.drawImage(s,.5*-s.width,.5*-s.height);var o=this.momEyeArr[this.momEyeIndex];e.drawImage(o,.5*-o.width,.5*-o.height),e.restore()};var T=function(){this.x=0,this.y=0,this.angle,this.babyTailArr=[],this.babyTailTimer=0,this.babyTailIndex=0,this.babyEyeArr=[],this.babyEyeTimer=0,this.babyEyeIndex=0,this.babyEyeInterval=1e3,this.babyBodyArr=[],this.babyBodyTimer=0,this.babyBodyIndex=0};T.prototype.init=function(){this.x=.5*s-50,this.y=.5*n+50,this.babyBodyIndex=0,this.angle=0;for(var t=0;t<8;t++)this.babyTailArr[t]=new Image,this.babyTailArr[t].src=g+"babyTail"+t+".png";for(t=0;t<2;t++)this.babyEyeArr[t]=new Image,this.babyEyeArr[t].src=g+"babyEye"+t+".png";for(t=0;t<20;t++)this.babyBodyArr[t]=new Image,this.babyBodyArr[t].src=g+"babyFade"+t+".png"},T.prototype.drawBaby=function(){this.x=r.lerpDistance(y.x,this.x,.98),this.y=r.lerpDistance(y.y,this.y,.99);var i=y.x-this.x,a=y.y-this.y,s=Math.atan2(a,i)+Math.PI;this.angle=r.lerpAngle(s,this.angle,.6),this.babyTailTimer+=x,this.babyTailTimer>50&&(this.babyTailIndex=(this.babyTailIndex+1)%8,this.babyTailTimer%=50),this.babyEyeTimer+=x,this.babyEyeTimer>this.babyEyeInterval&&(this.babyEyeIndex=(this.babyEyeIndex+1)%2,this.babyEyeTimer%=this.babyEyeInterval,0==this.babyEyeIndex?this.babyEyeInterval=1500*Math.random()+1500:this.babyEyeInterval=200),this.babyBodyTimer+=x,this.babyBodyTimer>550&&(this.babyBodyIndex+=1,this.babyBodyTimer%=550,d.strength=((20-this.babyBodyIndex)/2).toFixed(0),this.babyBodyIndex>19&&(this.babyBodyIndex=19,d.gameOver=!0,t.style.cursor="pointer")),e.save(),e.translate(this.x,this.y),e.rotate(this.angle);var n=this.babyTailArr[this.babyTailIndex];e.drawImage(n,.5*-n.width+24,.5*-n.height);var o=this.babyBodyArr[this.babyBodyIndex];e.drawImage(o,.5*-o.width,.5*-o.height);var h=this.babyEyeArr[this.babyEyeIndex];e.drawImage(h,.5*-h.width,.5*-h.height),e.restore()};var A=function(){this.fruitNum=0,this.doubleNum=1,this.score=0,this.strength=10,this.alpha=0,this.gameOver=!1};A.prototype.init=function(){this.fruitNum=0,this.doubleNum=1,this.score=0},A.prototype.drawScore=function(){e.fillText("num: "+this.fruitNum,.5*s,n-30),e.fillText("double: "+this.doubleNum,.5*s,n-70),e.save(),e.font="30px verdana",e.fillText("SCORE: "+this.score,.5*s,50),e.font="20px verdana",e.fillText("strength: ",650,45),d.strength<=3&&(e.fillStyle="red"),e.fillText(d.strength,710,45),d.gameOver&&(this.alpha+=5e-4*x,this.alpha>1&&(this.alpha=1),e.font="40px verdana",e.shadowBlur=10,e.shadowColor="white",e.fillStyle="rgba(255, 255, 255, "+this.alpha+")",e.fillText("GAME OVER",.5*s,.5*n-25),e.save(),e.font="25px verdana",e.fillText("CLICK TO RESTART",.5*s,.5*n+25),e.restore()),e.restore()},A.prototype.computeScore=function(){d.score+=d.fruitNum*d.doubleNum,this.fruitNum=0,this.doubleNum=1};var E=function(){this.num=10,this.x=[],this.y=[],this.r=[],this.status=[]};E.prototype.init=function(){for(var t=0;t<this.num;t++)this.x[t]=.5*s,this.y[t]=.5*n,this.status[t]=!1,this.r[t]=0},E.prototype.drawWave=function(){e.save(),e.lineWidth=3;for(var t=0;t<this.num;t++)if(this.status[t]){if(this.r[t]+=.04*x,this.r[t]>60)return this.status[t]=!1,!1;var i=1-this.r[t]/60;e.strokeStyle="rgba(255, 255, 255, "+i+")",e.beginPath(),e.arc(this.x[t],this.y[t],this.r[t],0,2*Math.PI),e.stroke()}e.restore()},E.prototype.born=function(t){for(var i=0;i<this.num;i++)if(!this.status[i])return this.status[i]=!0,this.x[i]=m.x[t],this.y[i]=m.y[t],this.r[i]=10,!1};var B=function(){this.num=5,this.x=[],this.y=[],this.r=[],this.status=[]};B.prototype.init=function(){for(var t=0;t<this.num;t++)this.x[t]=.5*s,this.y[t]=.5*n,this.status[t]=!1,this.r[t]=0},B.prototype.drawHalo=function(){e.save(),e.lineWidth=4;for(var t=0;t<this.num;t++)if(this.status[t]){if(this.r[t]+=.08*x,this.r[t]>100)return this.status[t]=!1,!1;var i=1-this.r[t]/100;e.strokeStyle="rgba(203, 91, 0, "+i+")",e.beginPath(),e.arc(this.x[t],this.y[t],this.r[t],0,2*Math.PI),e.stroke()}e.restore()},B.prototype.born=function(){for(var t=0;t<this.num;t++)if(!this.status[t])return this.status[t]=!0,this.x[t]=u.x,this.y[t]=u.y,this.r[t]=10,!1};var M=function(){this.num=30,this.dustPic=[],this.x=[],this.y=[],this.amp=[],this.index=[],this.beta=0};M.prototype.init=function(){for(var t=0;t<7;t++)this.dustPic[t]=new Image,this.dustPic[t].src=g+"dust"+t+".png";for(t=0;t<this.num;t++)this.x[t]=Math.random()*s,this.y[t]=Math.random()*n,this.amp=20+Math.random()+15,this.index[t]=Math.floor(7*Math.random())},M.prototype.drawDust=function(){for(var t=0;t<this.num;t++){var i=this.index[t];e.drawImage(this.dustPic[i],this.x,this.y)}}}()},function(t,i){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,i){return window.setTimeout(t,1e3/60)},t.exports={calLength2:function(t,i,e,r){return Math.sqrt(Math.pow(t-e,2)+Math.pow(i-r,2))},lerpAngle:function(t,i,e){var r=i-t;return r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI),t+r*e},lerpDistance:function(t,i,e){return t+(i-t)*e}}},function(t,i){}]);